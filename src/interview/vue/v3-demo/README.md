# Vue3 大文件上传与断点续传示例

这是一个基于Vue3、TypeScript和Element Plus实现的大文件上传和断点续传示例项目。

## 功能特点

- 大文件分片上传
- 断点续传
- 上传进度显示
- 暂停/继续上传
- 取消上传
- 文件秒传（通过文件标识符检测）

## 技术栈

- Vue 3
- TypeScript
- Element Plus
- Vite

## 项目结构

```
├── api/                # API服务
│   └── uploadService.ts # 上传接口服务模块
├── components/         # 组件
│   └── FileUpload.vue  # 文件上传组件
├── types/              # 类型定义
│   └── index.ts        # 类型声明
├── utils/              # 工具函数
│   └── fileUtils.ts    # 文件处理工具
├── App.vue             # 应用入口组件
├── main.ts             # 应用入口文件
├── vite.config.ts      # Vite配置
└── tsconfig.json       # TypeScript配置
```

## 安装与运行

### 1. 启动后端服务器

```bash
# 进入后端目录
cd d:/LearningCenter/frontend+/frontend-interview/src/interview/node_server/next.js

# 安装依赖
npm install

# 启动服务器
npm run dev
```

确保后端服务器在 http://localhost:3000 运行。

### 2. 启动前端项目

```bash
# 进入前端目录
cd d:/LearningCenter/frontend+/frontend-interview/src/interview/vue/v3-demo

# 安装依赖
npm install

# 启动开发服务器
npm run dev
```

前端项目将在 http://localhost:8080 运行。

## 实现原理

### 前端实现

1. **文件分片**：将大文件分割成小块（默认2MB一块）
2. **计算唯一标识**：根据文件名、大小和修改时间生成唯一标识
3. **检查已上传分片**：上传前先检查服务器上是否已有部分分片
4. **并发上传**：支持多个分片并发上传
5. **断点续传**：记录已上传的分片，支持从断点处继续上传
6. **合并请求**：所有分片上传完成后，发送合并请求

### 后端实现

1. **接收分片**：接收并存储前端上传的文件分片
2. **分片管理**：使用文件标识符创建临时目录存储分片
3. **断点续传支持**：提供API查询已上传的分片
4. **文件合并**：所有分片上传完成后合并为完整文件
5. **清理机制**：定期清理过期的临时文件

## 注意事项

- 本示例仅用于学习和演示，生产环境使用需要增加更多的安全措施
- 大文件上传需要考虑服务器存储空间和带宽限制
- 建议在上传前进行文件类型和大小的校验

## 常见问题排查

### API请求返回400错误

如果遇到API请求返回400错误，请检查：

1. 确保后端服务器已启动并正常运行在端口3000
2. 检查前端API请求路径是否正确
3. 检查请求参数格式是否符合后端要求
4. 查看浏览器控制台和后端服务器日志以获取更详细的错误信息

### 文件上传失败

如果文件上传失败，请检查：

1. 文件大小是否超过限制
2. 文件类型是否被允许
3. 上传目录是否有写入权限
4. 网络连接是否稳定

### 命名冲突问题

如果遇到函数命名冲突问题，请检查：

1. 确保组件中的本地函数名与导入的API服务函数名不重复
2. 使用不同的命名或添加前缀以区分本地函数和API函数